import{j as e,B as v,f as S,r as c,R as I,A as O,I as b,K as D,l as y,P as w,M as B,m as A,n as k,N as E,J as $,O as L,k as H,y as z,S as M,H as W}from"./index-DX4RbbSE.js";import{C as V}from"./config-global-BwHnWRtc.js";import{a as G}from"./index-Br0q4W-C.js";import{T,a as m,b as J,c as K,d as Q,e as q,f as U,g as X}from"./TableSortLabel-BeKEmkrD.js";import{C as R}from"./Checkbox-CP06dHPC.js";import{O as Y}from"./Select-Bj2xuOC5.js";import{C as Z}from"./Card-DhZeIV4e.js";import"./LastPage-qsknSfb6.js";function _({searchQuery:t,...r}){return e.jsx(T,{...r,children:e.jsx(m,{align:"center",colSpan:7,children:e.jsxs(v,{sx:{py:15,textAlign:"center"},children:[e.jsx(S,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(S,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function ee({row:t,selected:r,onSelectRow:l}){var h,f,i,p;const[o,s]=c.useState(null),d=I(),u=c.useCallback(n=>{n.stopPropagation(),s(n.currentTarget)},[]),a=c.useCallback(()=>{s(null)},[]),x=n=>{n.stopPropagation(),d(`/place/${t.id}`)},j=n=>{n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||d(`/place/${t.id}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{hover:!0,tabIndex:-1,role:"checkbox",selected:r,onClick:j,children:[e.jsx(m,{padding:"checkbox",children:e.jsx(R,{disableRipple:!0,checked:r,onChange:l})}),e.jsx(m,{component:"th",scope:"row",children:e.jsxs(v,{gap:2,display:"flex",alignItems:"center",children:[e.jsx(O,{alt:((h=t.placeTranslation[0])==null?void 0:h.name)||"N/A",src:t.photoDisplay}),((f=t.placeTranslation[0])==null?void 0:f.name)||"N/A"]})}),e.jsx(m,{children:((i=t.placeTranslation[0])==null?void 0:i.address)||"N/A"}),e.jsx(m,{children:((p=t.placeTranslation[0])==null?void 0:p.description)||"N/A"}),e.jsx(m,{align:"center",children:t.status==="0"?"-":e.jsx(b,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}})}),e.jsx(m,{children:e.jsx(D,{color:t.status==="0"?"warning":t.status==="1"?"success":t.status==="2"?"error":"default",children:t.status==="0"?"Pending":t.status==="1"?"Approved":t.status==="2"?"Rejected":t.status})}),e.jsx(m,{align:"right",children:e.jsxs(y,{onClick:x,children:[" ",e.jsx(b,{icon:"eva:arrow-forward-outline",width:22})]})}),e.jsx(m,{align:"right",children:e.jsxs(y,{onClick:u,children:[" ",e.jsx(b,{icon:"eva:more-vertical-fill",width:22})]})})]}),e.jsx(w,{open:!!o,anchorEl:o,onClose:a,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(B,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${k.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${k.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(A,{onClick:a,children:[e.jsx(b,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(A,{onClick:a,sx:{color:"error.main"},children:[e.jsx(b,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}const te={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function se(t,r,l){return t?Math.max(0,(1+t)*r-l):0}const ne=(t,r)=>(l,o)=>{if(r==="status"){const s=Number(l.status),d=Number(o.status);return t==="asc"?s-d:d-s}return 0},ae=({inputData:t,comparator:r,filterName:l,filterStatus:o})=>{let s=null;return o==="Pending"?s=0:o==="Approved"?s=1:o==="Rejected"&&(s=2),t.filter(u=>{const a=Number(u.status);return s!==null?a===s:!0}).sort(r)};function oe({order:t,onSort:r,orderBy:l,rowCount:o,headLabel:s,numSelected:d,onSelectAllRows:u}){return e.jsx(J,{children:e.jsxs(T,{children:[e.jsx(m,{padding:"checkbox",children:e.jsx(R,{indeterminate:d>0&&d<o,checked:o>0&&d===o,onChange:a=>u(a.target.checked)})}),s.map(a=>e.jsx(m,{align:a.align||"left",sortDirection:l===a.id?t:!1,sx:{width:a.width,minWidth:a.minWidth},children:e.jsxs(K,{hideSortIcon:!0,active:l===a.id,direction:l===a.id?t:"asc",onClick:()=>r(a.id),children:[a.label,l===a.id?e.jsx(v,{sx:{...te},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},a.id))]})})}function re({emptyRows:t,height:r,sx:l,...o}){return t?e.jsx(T,{sx:{...r&&{height:r*t},...l},...o,children:e.jsx(m,{colSpan:9})}):null}function le({numSelected:t,filterName:r,onFilterName:l,onFilterStatus:o}){const[s,d]=c.useState(null),[u,a]=c.useState(null),x=i=>{a(i),o(i),d(null)},j=i=>{d(i.currentTarget)},h=()=>{d(null)},f=!!s;return e.jsxs(E,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(S,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(Y,{fullWidth:!0,value:r,onChange:l,placeholder:"Search event...",startAdornment:e.jsx($,{position:"start",children:e.jsx(b,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),t>0?e.jsx(y,{children:e.jsx(b,{icon:"solar:trash-bin-trash-bold"})}):e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Filter list",children:e.jsx(y,{onClick:j,children:e.jsx(b,{icon:"ic:round-filter-list"})})}),e.jsx(w,{open:f,anchorEl:s,onClose:h,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(v,{sx:{p:2,display:"flex",flexDirection:"column",gap:1},children:["All","Pending","Approved","Rejected"].map(i=>e.jsx(H,{variant:u===(i==="All"?null:i)?"contained":"outlined",onClick:()=>x(i==="All"?null:i),sx:{color:u===(i==="All"?null:i)?"text.primary":"text.secondary",borderColor:"text.secondary"},children:i},i))})})]})]})}const ie=async(t=1,r=5,l="vi")=>{const o=localStorage.getItem("accessToken");if(console.log("Access Token:",o),!o)return console.error("No access token found"),{items:[],totalCount:0};try{const s=await G.get(`https://api.localtour.space/api/Place/getAll?LanguageCode=${l}&Page=${t}&Size=${r}`,{headers:{Authorization:`Bearer ${o}`}});return console.log("API Response:",s.data),{items:s.data.items,totalCount:s.data.totalCount}}catch(s){return console.error("Error fetching places",s),{items:[],totalCount:0}}};function ce(){const[t,r]=c.useState([]),[l,o]=c.useState(0),[s,d]=c.useState(""),[u,a]=c.useState("vi"),[x,j]=c.useState(1),[h,f]=c.useState(5),[i,p]=c.useState("All");c.useEffect(()=>{(async()=>{const{items:P,totalCount:F}=await ie(x,h,u);r(P),o(F)})()},[x,h,u]);const n=de(),C=ae({inputData:t,comparator:ne(n.order,n.orderBy),filterName:s,filterStatus:i}),N=!C.length&&!!s;return e.jsxs(z,{children:[e.jsx(v,{display:"flex",alignItems:"center",mb:5,children:e.jsx(S,{variant:"h4",flexGrow:1,children:"Places"})}),e.jsxs(Z,{children:[e.jsx(le,{numSelected:n.selected.length,filterName:s,onFilterName:g=>{d(g.target.value),n.onResetPage()},onFilterStatus:p}),e.jsx(M,{children:e.jsx(Q,{sx:{overflow:"unset"},children:e.jsxs(q,{sx:{minWidth:800},children:[e.jsx(oe,{order:n.order,orderBy:n.orderBy,rowCount:t.length,numSelected:n.selected.length,onSort:n.onSort,onSelectAllRows:g=>n.onSelectAllRows(g,t.map(P=>P.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),e.jsxs(U,{children:[C.slice(n.page*h,n.page*h+h).map(g=>e.jsx(ee,{row:g,selected:n.selected.includes(g.id),onSelectRow:()=>n.onSelectRow(g.id)},g.id)),e.jsx(re,{height:68,emptyRows:se(n.page,n.rowsPerPage,t.length)}),N&&e.jsx(_,{searchQuery:s})]})]})})}),e.jsx(X,{component:"div",page:x-1,count:l,rowsPerPage:h,onPageChange:(g,P)=>j(P+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:g=>{f(parseInt(g.target.value,10)),j(1)}})]})]})}function de(){const[t,r]=c.useState(0),[l,o]=c.useState("name"),[s,d]=c.useState(5),[u,a]=c.useState([]),[x,j]=c.useState("asc"),h=c.useCallback(p=>{j(l===p&&x==="asc"?"desc":"asc"),o(p)},[x,l]),f=c.useCallback((p,n)=>{if(p){a(n);return}a([])},[]),i=c.useCallback(p=>{const n=u.includes(p)?u.filter(C=>C!==p):[...u,p];a(n)},[u]);return{order:x,orderBy:l,rowsPerPage:s,selected:u,page:t,onSort:h,onSelectAllRows:f,onSelectRow:i,onResetPage:()=>r(0)}}function be(){return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs("title",{children:[" ",`Places - ${V.appName}`]})}),e.jsx(ce,{})]})}export{be as default};
