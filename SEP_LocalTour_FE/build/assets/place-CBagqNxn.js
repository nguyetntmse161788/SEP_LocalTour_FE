import{r as s,j as t,y,B as j,f as R,S as T,H as A}from"./index-BCEoXUgR.js";import{C as B}from"./config-global-BwHnWRtc.js";import{a as N}from"./index-Br0q4W-C.js";import{a as F,g as v,P as D,b as k,c as $,T as I,e as E,d as O}from"./place-table-toolbar-ChhY3a9s.js";import{C as H}from"./Card-CnlOfLcQ.js";import{b as L,c as V,d as z,e as G}from"./TableSortLabel-D4yi4Kr4.js";import"./DialogTitle-DLFL-6md.js";import"./Autocomplete-Db5_biKL.js";import"./Select-BESDqWty.js";import"./TextField-DWe7D0BL.js";import"./InputLabel-b21gl_J5.js";import"./Grid-ClQYLn49.js";import"./Checkbox-B8ndejfx.js";import"./LastPage-CTy_b4eb.js";const Q=async(n=1,m=5,i="vi",h="",r="")=>{const p=localStorage.getItem("accessToken");if(console.log("Access Token:",p),!p)return console.error("No access token found"),{items:[],totalCount:0};try{const o=await N.get(`https://api.localtour.space/api/Place/getAllByRole?LanguageCode=${i}&Page=${n}&Size=${m}&SearchTerm=${encodeURIComponent(h)}&Status=${r}`,{headers:{Authorization:`Bearer ${p}`}});return console.log("API Response:",o.data),{items:o.data.items,totalCount:o.data.totalCount}}catch(o){return console.error("Error fetching places",o),{items:[],totalCount:0}}};function U(){const[n,m]=s.useState([]),[i,h]=s.useState(0),[r,p]=s.useState(""),[o,P]=s.useState("vi"),[d,g]=s.useState(1),[c,b]=s.useState(5),[S,l]=s.useState("");s.useEffect(()=>{(async()=>{const{items:u,totalCount:x}=await Q(d,c,o,r,S);m(u),h(x)})()},[d,c,o,r,S]);const e=W(),f=F({inputData:n,comparator:v(e.order,e.orderBy),filterName:r,filterStatus:S}),C=a=>{m(u=>u.filter(x=>x.id!==a))},w=!f.length&&!!r;return t.jsxs(y,{children:[t.jsx(j,{display:"flex",alignItems:"center",mb:5,children:t.jsx(R,{variant:"h4",flexGrow:1,children:"Places"})}),t.jsxs(H,{children:[t.jsx(D,{numSelected:e.selected.length,filterName:r,onFilterName:a=>{p(a.target.value),g(1)},onFilterStatus:a=>{l(a||""),g(1)}}),t.jsx(T,{children:t.jsx(L,{sx:{overflow:"unset"},children:t.jsxs(V,{sx:{minWidth:800},children:[t.jsx(k,{order:e.order,orderBy:e.orderBy,rowCount:n.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:a=>e.onSelectAllRows(a,n.map(u=>u.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),t.jsxs(z,{children:[f.slice(e.page*c,e.page*c+c).map(a=>t.jsx($,{row:a,selected:e.selected.includes(a.id),onSelectRow:()=>e.onSelectRow(a.id),onDeletePlace:C},a.id)),t.jsx(I,{height:68,emptyRows:E(e.page,e.rowsPerPage,n.length)}),w&&t.jsx(O,{searchQuery:r})]})]})})}),t.jsx(G,{component:"div",page:d-1,count:i,rowsPerPage:c,onPageChange:(a,u)=>g(u+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:a=>{b(parseInt(a.target.value,10)),g(1)}})]})]})}function W(){const[n,m]=s.useState(0),[i,h]=s.useState("name"),[r,p]=s.useState(5),[o,P]=s.useState([]),[d,g]=s.useState("asc"),c=s.useCallback(l=>{g(i===l&&d==="asc"?"desc":"asc"),h(l)},[d,i]),b=s.useCallback((l,e)=>{if(l){P(e);return}P([])},[]),S=s.useCallback(l=>{const e=o.includes(l)?o.filter(f=>f!==l):[...o,l];P(e)},[o]);return{order:d,orderBy:i,rowsPerPage:r,selected:o,page:n,onSort:c,onSelectAllRows:b,onSelectRow:S,onResetPage:()=>m(0)}}function le(){return t.jsxs(t.Fragment,{children:[t.jsx(A,{children:t.jsxs("title",{children:[" ",`Places - ${B.appName}`]})}),t.jsx(U,{})]})}export{le as default};
