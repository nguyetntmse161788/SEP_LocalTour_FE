import{aI as b,K as A,r as t,j as e,B as l,f as s,m as a,k as g,H as F}from"./index-CqOrFkS9.js";import{C as N}from"./config-global-BwHnWRtc.js";import{a as p}from"./index-Br0q4W-C.js";import{C as k}from"./Card-BGRQsCGj.js";import{C as P}from"./CardContent-BB5Ecx1y.js";import{F as E,I as T}from"./InputLabel-_37qWNMV.js";import{S as U}from"./Select-BH5qWtTR.js";function $(){const j=b(),f=A(),[v,y]=t.useState([]),{user:C,userId:o,userName:c,role:R}=j.state||{},[n,S]=t.useState(R||""),[d,i]=t.useState(""),[h,B]=t.useState(""),m=localStorage.getItem("accessToken"),u=t.useCallback(async()=>{try{const r=await p.get("https://api.localtour.space/api/roles");y(r.data)}catch{i("Failed to fetch roles")}},[]);t.useEffect(()=>{u()},[u]);const w=r=>{S(r.target.value)},I=async()=>{if(!m){i("Authentication required. Please log in again.");return}try{const r=`https://api.localtour.space/api/User/addRole?userId=${o}&role=${n}`;(await p.post(r,{userId:o,userName:c,role:n},{headers:{Authorization:`Bearer ${m}`}})).status===200&&B("Role updated successfully!")}catch{i("Failed to update role. Please try again.")}};return e.jsx(l,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"70vh",bgcolor:"#f9f9f9",sx:{maxWidth:"90vw",padding:2},children:e.jsx(k,{sx:{width:400,padding:3},children:e.jsxs(P,{children:[e.jsx(s,{variant:"h5",align:"center",marginBottom:2,children:"User Role Page"}),d&&e.jsx(s,{color:"error",variant:"body2",align:"center",marginBottom:2,children:d}),h&&e.jsx(s,{color:"success.main",variant:"body2",align:"center",marginBottom:2,children:h}),C&&e.jsxs(e.Fragment,{children:[e.jsxs(s,{variant:"body1",marginBottom:1,children:[e.jsx("strong",{children:"ID:"})," ",o]}),e.jsxs(s,{variant:"body1",marginBottom:1,children:[e.jsx("strong",{children:"User Name:"})," ",c]}),e.jsxs(s,{variant:"body1",marginBottom:1,children:[e.jsx("strong",{children:"Current Role:"}),e.jsx("ul",{children:v.map((r,x)=>e.jsx("li",{children:r},x))})]}),e.jsxs(E,{fullWidth:!0,margin:"normal",children:[e.jsx(T,{children:"New Role"}),e.jsxs(U,{value:n,onChange:w,label:"New Role",children:[e.jsx(a,{value:"Moderator",children:"Moderator"}),e.jsx(a,{value:"Administrator",children:"Administrator"}),e.jsx(a,{value:"Visitor",children:"Visitor"}),e.jsx(a,{value:"Service Owner",children:"Service Owner"})]})]}),e.jsx(l,{textAlign:"center",marginTop:2,children:e.jsx(g,{variant:"contained",color:"primary",onClick:I,sx:{width:"100%"},children:"Save Role"})})]}),e.jsx(l,{textAlign:"center",marginTop:2,children:e.jsx(g,{variant:"text",onClick:()=>f("/admin/user"),sx:{width:"100%"},children:"Go to Profile"})})]})})})}function q(){return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:e.jsxs("title",{children:[" ",`Blog - ${N.appName}`]})}),e.jsx($,{})]})}export{q as default};
