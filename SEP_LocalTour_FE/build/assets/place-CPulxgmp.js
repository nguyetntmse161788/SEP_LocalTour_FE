import{r as s,j as a,y as j,B as R,f as T,S as A,H as B}from"./index-DUX23g0E.js";import{C as N}from"./config-global-BwHnWRtc.js";import{a as F}from"./axiosInstance-DCuNI-kV.js";import{a as v,g as D,P as k,b as I,c as $,T as E,e as O,d as H}from"./place-table-toolbar-C-cZK3xd.js";import{C as L}from"./Card-CfNpMCOC.js";import{b as U,c as V,d as z,e as G}from"./TableSortLabel-2OFHYdxw.js";import"./index-Br0q4W-C.js";import"./DialogTitle-Bksj2ejr.js";import"./Autocomplete-DBpAOSAN.js";import"./Select-CoLeV2jR.js";import"./TextField-DgaCIWDs.js";import"./InputLabel-6HE52FsW.js";import"./Grid-Bx36BDWb.js";import"./Checkbox-2R0jymSI.js";import"./LastPage-B31ot4Y2.js";const Q=async(c=1,d=5,u="vi",P="",r="")=>{const p=localStorage.getItem("accessToken");if(console.log("Access Token:",p),!p)return console.error("No access token found"),{items:[],totalCount:0};try{const o=await F.get(`https://api.localtour.space/api/Place/getAllByRole?LanguageCode=${u}&Page=${c}&Size=${d}&SearchTerm=${encodeURIComponent(P)}&Status=${r}`,{headers:{Authorization:`Bearer ${p}`}});return console.log("API Response:",o.data),{items:o.data.items,totalCount:o.data.totalCount}}catch(o){return console.error("Error fetching places",o),{items:[],totalCount:0}}};function W(){const[c,d]=s.useState([]),[u,P]=s.useState(0),[r,p]=s.useState(""),[o,f]=s.useState("vi"),[m,g]=s.useState(1),[i,x]=s.useState(5),[S,n]=s.useState("");s.useEffect(()=>{(async()=>{const{items:l,totalCount:h}=await Q(m,i,o,r,S);d(l),P(h)})()},[m,i,o,r,S]);const e=q(),b=v({inputData:c,comparator:D(e.order,e.orderBy),filterName:r,filterStatus:S}),C=t=>{d(l=>l.filter(h=>h.id!==t))},w=t=>{d(l=>l.map(h=>h.id===t.id?t:h))},y=!b.length&&!!r;return a.jsxs(j,{children:[a.jsx(R,{display:"flex",alignItems:"center",mb:5,children:a.jsx(T,{variant:"h4",flexGrow:1,children:"Places"})}),a.jsxs(L,{children:[a.jsx(k,{numSelected:e.selected.length,filterName:r,onFilterName:t=>{p(t.target.value),g(1)},onFilterStatus:t=>{n(t||""),g(1)}}),a.jsx(A,{children:a.jsx(U,{sx:{overflow:"unset"},children:a.jsxs(V,{sx:{minWidth:800},children:[a.jsx(I,{order:e.order,orderBy:e.orderBy,rowCount:c.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:t=>e.onSelectAllRows(t,c.map(l=>l.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),a.jsxs(z,{children:[b.slice(e.page*i,e.page*i+i).map(t=>a.jsx($,{row:t,selected:e.selected.includes(t.id),onSelectRow:()=>e.onSelectRow(t.id),onDeletePlace:C,onUpdatePlace:w},t.id)),a.jsx(E,{height:68,emptyRows:O(e.page,e.rowsPerPage,c.length)}),y&&a.jsx(H,{searchQuery:r})]})]})})}),a.jsx(G,{component:"div",page:m-1,count:u,rowsPerPage:i,onPageChange:(t,l)=>g(l+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:t=>{x(parseInt(t.target.value,10)),g(1)}})]})]})}function q(){const[c,d]=s.useState(0),[u,P]=s.useState("name"),[r,p]=s.useState(5),[o,f]=s.useState([]),[m,g]=s.useState("asc"),i=s.useCallback(n=>{g(u===n&&m==="asc"?"desc":"asc"),P(n)},[m,u]),x=s.useCallback((n,e)=>{if(n){f(e);return}f([])},[]),S=s.useCallback(n=>{const e=o.includes(n)?o.filter(b=>b!==n):[...o,n];f(e)},[o]);return{order:m,orderBy:u,rowsPerPage:r,selected:o,page:c,onSort:i,onSelectAllRows:x,onSelectRow:S,onResetPage:()=>d(0)}}function ce(){return a.jsxs(a.Fragment,{children:[a.jsx(B,{children:a.jsxs("title",{children:[" ",`Places - ${N.appName}`]})}),a.jsx(W,{})]})}export{ce as default};
