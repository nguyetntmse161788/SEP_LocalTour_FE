import{j as e,B as S,f as v,r as c,K as F,A as O,I as b,Q as D,l as y,P as w,M as B,m as k,n as A,N as E,J as $,O as L,k as H,y as z,S as M,H as W}from"./index-CqOrFkS9.js";import{C as V}from"./config-global-BwHnWRtc.js";import{a as G}from"./index-Br0q4W-C.js";import{T,a as g,f as Q,g as J,b as K,c as U,d as q,e as X}from"./TableSortLabel-Bt7vdYS2.js";import{C as R}from"./Checkbox-C3wUofvP.js";import{O as Y}from"./Select-BH5qWtTR.js";import{C as Z}from"./Card-BGRQsCGj.js";import"./LastPage-DAK7OL3M.js";function _({searchQuery:t,...o}){return e.jsx(T,{...o,children:e.jsx(g,{align:"center",colSpan:7,children:e.jsxs(S,{sx:{py:15,textAlign:"center"},children:[e.jsx(v,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(v,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function ee({row:t,selected:o,onSelectRow:r}){var x,f,a,u;const[h,n]=c.useState(null),d=F(),i=c.useCallback(s=>{s.stopPropagation(),n(s.currentTarget)},[]),l=c.useCallback(()=>{n(null)},[]),m=s=>{s.stopPropagation(),d(`/place/${t.id}`)},j=s=>{s.target instanceof HTMLButtonElement||s.target instanceof HTMLInputElement||d(`/place/${t.id}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(T,{hover:!0,tabIndex:-1,role:"checkbox",selected:o,onClick:j,children:[e.jsx(g,{padding:"checkbox",children:e.jsx(R,{disableRipple:!0,checked:o,onChange:r})}),e.jsx(g,{component:"th",scope:"row",children:e.jsxs(S,{gap:2,display:"flex",alignItems:"center",children:[e.jsx(O,{alt:((x=t.placeTranslation[0])==null?void 0:x.name)||"N/A",src:t.photoDisplay}),((f=t.placeTranslation[0])==null?void 0:f.name)||"N/A"]})}),e.jsx(g,{children:((a=t.placeTranslation[0])==null?void 0:a.address)||"N/A"}),e.jsx(g,{children:((u=t.placeTranslation[0])==null?void 0:u.description)||"N/A"}),e.jsx(g,{align:"center",children:t.status==="Pending"?"-":e.jsx(b,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}})}),e.jsx(g,{children:e.jsx(D,{color:t.status==="Pending"?"warning":t.status==="Approved"?"success":t.status==="Rejected"?"error":"default",children:t.status})}),e.jsx(g,{align:"right",children:e.jsxs(y,{onClick:m,children:[" ",e.jsx(b,{icon:"eva:arrow-forward-outline",width:22})]})}),e.jsx(g,{align:"right",children:e.jsxs(y,{onClick:i,children:[" ",e.jsx(b,{icon:"eva:more-vertical-fill",width:22})]})})]}),e.jsx(w,{open:!!h,anchorEl:h,onClose:l,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(B,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${A.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${A.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(k,{onClick:l,children:[e.jsx(b,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(k,{onClick:l,sx:{color:"error.main"},children:[e.jsx(b,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}const te={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function se(t,o,r){return t?Math.max(0,(1+t)*o-r):0}const ne=(t,o)=>(r,h)=>{if(o==="status"){const n=Number(r.status),d=Number(h.status);return t==="asc"?n-d:d-n}return 0},ae=({inputData:t,comparator:o,filterName:r,filterStatus:h})=>{const n=[...t];return n.sort(o),n};function oe({order:t,onSort:o,orderBy:r,rowCount:h,headLabel:n,numSelected:d,onSelectAllRows:i}){return e.jsx(Q,{children:e.jsxs(T,{children:[e.jsx(g,{padding:"checkbox",children:e.jsx(R,{indeterminate:d>0&&d<h,checked:h>0&&d===h,onChange:l=>i(l.target.checked)})}),n.map(l=>e.jsx(g,{align:l.align||"left",sortDirection:r===l.id?t:!1,sx:{width:l.width,minWidth:l.minWidth},children:e.jsxs(J,{hideSortIcon:!0,active:r===l.id,direction:r===l.id?t:"asc",onClick:()=>o(l.id),children:[l.label,r===l.id?e.jsx(S,{sx:{...te},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))]})})}function re({emptyRows:t,height:o,sx:r,...h}){return t?e.jsx(T,{sx:{...o&&{height:o*t},...r},...h,children:e.jsx(g,{colSpan:9})}):null}function le({numSelected:t,filterName:o,onFilterName:r,onFilterStatus:h}){const[n,d]=c.useState(null),[i,l]=c.useState(null),m=a=>{const u=a==="All"?"":a;l(u),h(u),d(null)},j=a=>{d(a.currentTarget)},x=()=>{d(null)},f=!!n;return e.jsxs(E,{sx:{height:96,display:"flex",justifyContent:"space-between",p:a=>a.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(v,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(Y,{fullWidth:!0,value:o,onChange:r,placeholder:"Search place...",startAdornment:e.jsx($,{position:"start",children:e.jsx(b,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),t>0?e.jsx(y,{children:e.jsx(b,{icon:"solar:trash-bin-trash-bold"})}):e.jsxs(e.Fragment,{children:[e.jsx(L,{title:"Filter list",children:e.jsx(y,{onClick:j,children:e.jsx(b,{icon:"ic:round-filter-list"})})}),e.jsx(w,{open:f,anchorEl:n,onClose:x,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(S,{sx:{p:2,display:"flex",flexDirection:"column",gap:1},children:["All","Pending","Approved","Rejected"].map(a=>e.jsx(H,{variant:i===(a==="All"?null:a)?"contained":"outlined",onClick:()=>m(a==="All"?null:a),sx:{color:i===(a==="All"?null:a)?"text.primary":"text.secondary",borderColor:"text.secondary"},children:a},a))})})]})]})}const ie=async(t=1,o=5,r="vi",h="",n="")=>{const d=localStorage.getItem("accessToken");if(console.log("Access Token:",d),!d)return console.error("No access token found"),{items:[],totalCount:0};try{const i=await G.get(`https://api.localtour.space/api/Place/getAllByRole?LanguageCode=${r}&Page=${t}&Size=${o}&SearchTerm=${encodeURIComponent(h)}&Status=${n}`,{headers:{Authorization:`Bearer ${d}`}});return console.log("API Response:",i.data),{items:i.data.items,totalCount:i.data.totalCount}}catch(i){return console.error("Error fetching places",i),{items:[],totalCount:0}}};function ce(){const[t,o]=c.useState([]),[r,h]=c.useState(0),[n,d]=c.useState(""),[i,l]=c.useState("vi"),[m,j]=c.useState(1),[x,f]=c.useState(5),[a,u]=c.useState("");c.useEffect(()=>{(async()=>{const{items:P,totalCount:I}=await ie(m,x,i,n,a);o(P),h(I)})()},[m,x,i,n,a]);const s=de(),C=ae({inputData:t,comparator:ne(s.order,s.orderBy),filterName:n,filterStatus:a}),N=!C.length&&!!n;return e.jsxs(z,{children:[e.jsx(S,{display:"flex",alignItems:"center",mb:5,children:e.jsx(v,{variant:"h4",flexGrow:1,children:"Places"})}),e.jsxs(Z,{children:[e.jsx(le,{numSelected:s.selected.length,filterName:n,onFilterName:p=>{d(p.target.value),j(1)},onFilterStatus:p=>{u(p||""),j(1)}}),e.jsx(M,{children:e.jsx(K,{sx:{overflow:"unset"},children:e.jsxs(U,{sx:{minWidth:800},children:[e.jsx(oe,{order:s.order,orderBy:s.orderBy,rowCount:t.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:p=>s.onSelectAllRows(p,t.map(P=>P.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),e.jsxs(q,{children:[C.slice(s.page*x,s.page*x+x).map(p=>e.jsx(ee,{row:p,selected:s.selected.includes(p.id),onSelectRow:()=>s.onSelectRow(p.id)},p.id)),e.jsx(re,{height:68,emptyRows:se(s.page,s.rowsPerPage,t.length)}),N&&e.jsx(_,{searchQuery:n})]})]})})}),e.jsx(X,{component:"div",page:m-1,count:r,rowsPerPage:x,onPageChange:(p,P)=>j(P+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:p=>{f(parseInt(p.target.value,10)),j(1)}})]})]})}function de(){const[t,o]=c.useState(0),[r,h]=c.useState("name"),[n,d]=c.useState(5),[i,l]=c.useState([]),[m,j]=c.useState("asc"),x=c.useCallback(u=>{j(r===u&&m==="asc"?"desc":"asc"),h(u)},[m,r]),f=c.useCallback((u,s)=>{if(u){l(s);return}l([])},[]),a=c.useCallback(u=>{const s=i.includes(u)?i.filter(C=>C!==u):[...i,u];l(s)},[i]);return{order:m,orderBy:r,rowsPerPage:n,selected:i,page:t,onSort:x,onSelectAllRows:f,onSelectRow:a,onResetPage:()=>o(0)}}function be(){return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs("title",{children:[" ",`Places - ${V.appName}`]})}),e.jsx(ce,{})]})}export{be as default};
