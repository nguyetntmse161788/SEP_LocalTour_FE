import{r as l,j as e,k as p,av as R,R as W,y as w,B as o,f as s,I as A,H as $}from"./index-DX4RbbSE.js";import{C as z}from"./config-global-BwHnWRtc.js";import{a as I}from"./index-Br0q4W-C.js";import{D as L,a as V,b as G,c as H}from"./DialogTitle-DE4LLfYA.js";import{T as D}from"./TextField-BBj8J8HQ.js";import{C as Z}from"./CircularProgress-BHXV3GkW.js";import{G as c}from"./Grid-CpEp-njR.js";import{C as E}from"./Card-DhZeIV4e.js";import"./Select-Bj2xuOC5.js";function q({open:d,onClose:t,onEventCreated:T,placeId:S}){const[x,g]=l.useState(""),[m,f]=l.useState(""),[u,v]=l.useState(""),[y,j]=l.useState(""),b=async()=>{const i=localStorage.getItem("accessToken");if(!i){console.error("No access token found");return}const a=new Date(u).toISOString(),r=new Date(y).toISOString(),n=new FormData;n.append("placeid",S),n.append("eventName",x),n.append("description",m),n.append("startDate",a),n.append("endDate",r),console.log("Data being sent to API:",n);try{const h=await I.post("https://api.localtour.space/api/Event/create",n,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"multipart/form-data"}});console.log("Event created response:",h.data),T(h.data),t(),C()}catch(h){console.error("Error creating event",h)}},C=()=>{g(""),f(""),v(""),j("")};return e.jsxs(L,{open:d,onClose:t,children:[e.jsx(V,{children:"Create Event"}),e.jsxs(G,{children:[e.jsx(D,{label:"Event Name",fullWidth:!0,value:x,onChange:i=>g(i.target.value),margin:"normal"}),e.jsx(D,{label:"Description",fullWidth:!0,value:m,onChange:i=>f(i.target.value),margin:"normal"}),e.jsx(D,{label:"Start Date",type:"datetime-local",fullWidth:!0,value:u,onChange:i=>v(i.target.value),margin:"normal"}),e.jsx(D,{label:"End Date",type:"datetime-local",fullWidth:!0,value:y,onChange:i=>j(i.target.value),margin:"normal"})]}),e.jsxs(H,{children:[e.jsx(p,{onClick:t,color:"primary",children:"Cancel"}),e.jsx(p,{onClick:b,color:"primary",children:"Create"})]})]})}function J(){var j,b,C,i;const{id:d}=R(),[t,T]=l.useState(null),[S,x]=l.useState([]),[g,m]=l.useState(!0),[f,u]=l.useState(!1),v=W(),y=a=>{x(r=>[...r,a])};return l.useEffect(()=>{(async()=>{const r=localStorage.getItem("accessToken");if(!r){console.error("No access token found");return}try{const n=await I.get(`https://api.localtour.space/api/Place/getPlaceById?languageCode=vi&placeid=${d}`,{headers:{Authorization:`Bearer ${r}`}});T(n.data),m(!1)}catch(n){console.error("Error fetching place details",n),m(!1)}})()},[d]),l.useEffect(()=>{d&&(async()=>{const r=localStorage.getItem("accessToken");if(!r){console.error("No access token found");return}try{const n=await I.get(`https://api.localtour.space/api/Event/getall?placeid=${d}`,{headers:{Authorization:`Bearer ${r}`}});console.log("Place events data:",n.data.items),x(n.data.items)}catch(n){console.error("Error fetching place events",n)}})()},[d]),g?e.jsx(w,{children:e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(Z,{})})}):t?(t.status,t.status,t.status,e.jsxs(w,{children:[e.jsxs(o,{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(p,{variant:"outlined",color:"primary",startIcon:e.jsx(A,{icon:"eva:arrow-back-fill"}),onClick:()=>v("/owner/event"),children:"Back to List"}),e.jsx(s,{variant:"h4",children:"Place Detail"}),e.jsx(p,{variant:"contained",color:"secondary",startIcon:e.jsx(A,{icon:"mingcute:edit-line"}),children:"Edit"})]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:4,children:e.jsx(E,{sx:{p:2,boxShadow:3},children:e.jsx(o,{mb:2,display:"flex",justifyContent:"center",children:e.jsx("img",{src:t.photoDisplay,alt:(j=t.placeTranslations[0])==null?void 0:j.name,style:{width:"100%",height:"auto",maxHeight:"400px",objectFit:"cover"}})})})}),e.jsxs(c,{item:!0,xs:12,md:8,children:[e.jsxs(E,{sx:{p:3,boxShadow:3},children:[e.jsx(s,{variant:"h5",mb:2,children:(b=t.placeTranslations[0])==null?void 0:b.name}),e.jsxs(s,{variant:"body1",mb:2,children:["Address: ",(C=t.placeTranslations[0])==null?void 0:C.address]}),e.jsxs(s,{variant:"body1",mb:2,children:["Description: ",(i=t.placeTranslations[0])==null?void 0:i.description]}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{variant:"h6",children:["Opening Time: ",t.timeOpen]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{variant:"h6",children:["Closing Time: ",t.timeClose]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{variant:"h6",children:["Longitude: ",t.longitude]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{variant:"h6",children:["Latitude: ",t.latitude]})}),e.jsx(c,{item:!0,xs:6,children:e.jsxs(s,{variant:"h6",children:["Status: ",t.status==="1"?"Approved":t.status==="2"?"Rejected":"Pending"]})})]})]}),t.placeTranslations.length>1&&e.jsxs(E,{sx:{mt:3,p:3,boxShadow:3},children:[e.jsx(s,{variant:"h6",mb:2,children:"Other Translations:"}),t.placeTranslations.map((a,r)=>e.jsxs(o,{mb:2,children:[e.jsxs(s,{variant:"body1",children:["Name: ",a.name]}),e.jsxs(s,{variant:"body1",children:["Description: ",a.description]}),e.jsxs(s,{variant:"body1",children:["Address: ",a.address]}),e.jsxs(s,{variant:"body1",children:["Contact: ",a.contact]})]},r))]})]})]}),e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(s,{variant:"h5",children:"Place Events"}),e.jsx(p,{variant:"contained",color:"primary",startIcon:e.jsx(A,{icon:"mingcute:add-line"}),onClick:()=>u(!0),children:"Create Event"})]}),S.length>0&&e.jsx(o,{mt:4,children:e.jsx(c,{container:!0,spacing:3,children:t.placeActivities.map(a=>{var r,n,h,N,P,k,F,B,O;return e.jsx(c,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsxs(E,{sx:{p:2,boxShadow:2,borderRadius:2},children:[e.jsxs(o,{position:"relative",mb:2,children:[a.photoDisplay?e.jsx("img",{src:a.photoDisplay,alt:((r=a.placeActivityTranslations[0])==null?void 0:r.activityName)||"Activity",style:{width:"100%",height:"auto",borderRadius:"8px",objectFit:"cover"}}):e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",sx:{width:"100%",height:200,borderRadius:"8px",backgroundColor:"#f0f0f0",fontSize:"3rem",fontWeight:"bold",color:"#888"},children:(h=(n=a.placeActivityTranslations[0])==null?void 0:n.activityName)==null?void 0:h.charAt(0)}),((N=a.placeActivityTranslations[0])==null?void 0:N.discount)>0&&e.jsx(o,{position:"absolute",top:8,right:8,bgcolor:"error.main",color:"white",px:1,py:.5,borderRadius:1,fontSize:"12px",fontWeight:"bold",children:"SALE"})]}),e.jsx(s,{variant:"h6",fontWeight:"bold",textAlign:"center",mb:1,children:(P=a.placeActivityTranslations[0])==null?void 0:P.activityName}),e.jsxs(o,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{children:e.jsx(s,{variant:"subtitle1",color:"text.secondary",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:(k=a.placeActivityTranslations[0])!=null&&k.priceType&&/^[A-Z]{3}$/.test((F=a.placeActivityTranslations[0])==null?void 0:F.priceType)?(B=a.placeActivityTranslations[0])==null?void 0:B.priceType:"VND"}).format((O=a.placeActivityTranslations[0])==null?void 0:O.price)})}),e.jsx(p,{variant:"outlined",size:"small",color:"primary",children:"View"})]})]})},a.id)})})}),e.jsx(q,{open:f,onClose:()=>u(!1),onEventCreated:y,placeId:d||""})]})):e.jsx(w,{children:e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:e.jsx(s,{variant:"h5",children:"Place not found"})})})}function ae(){return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsxs("title",{children:[" ",`Place Details - ${z.appName}`]})}),e.jsx(J,{})]})}export{ae as default};
