import{r as t,j as e,y as x,B as w,f as j,S as y,H as R}from"./index-B2v2_DKC.js";import{C as T}from"./config-global-BwHnWRtc.js";import{a as k}from"./index-Br0q4W-C.js";import{a as v,g as A,P as N,b as B,c as F,T as D,e as I,d as E}from"./place-table-toolbar-Bghj7UMr.js";import{C as $}from"./Card-DGcZmdxA.js";import{d as O,e as H,f as L,g as V}from"./TableSortLabel-BwsI00UK.js";import"./Checkbox-uchoM3R5.js";import"./Select-TXDlS2nK.js";import"./LastPage-CE1CEipW.js";const z=async(n=1,m=5,d="vi")=>{const u=localStorage.getItem("accessToken");if(console.log("Access Token:",u),!u)return console.error("No access token found"),{items:[],totalCount:0};try{const r=await k.get(`https://api.localtour.space/api/Place/getAll?LanguageCode=${d}&Page=${n}&Size=${m}`,{headers:{Authorization:`Bearer ${u}`}});return console.log("API Response:",r.data),{items:r.data.items,totalCount:r.data.totalCount}}catch(r){return console.error("Error fetching places",r),{items:[],totalCount:0}}};function G(){const[n,m]=t.useState([]),[d,u]=t.useState(0),[r,b]=t.useState(""),[l,h]=t.useState("vi"),[g,P]=t.useState(1),[c,f]=t.useState(5);t.useEffect(()=>{(async()=>{const{items:s,totalCount:i}=await z(g,c,l);m(s),u(i)})()},[g,c,l]);const a=Q(),p=v({inputData:n,comparator:A(a.order,a.orderBy),filterName:r}),C=!p.length&&!!r;return e.jsxs(x,{children:[e.jsx(w,{display:"flex",alignItems:"center",mb:5,children:e.jsx(j,{variant:"h4",flexGrow:1,children:"Places"})}),e.jsxs($,{children:[e.jsx(N,{numSelected:a.selected.length,filterName:r,onFilterName:o=>{b(o.target.value),a.onResetPage()}}),e.jsx(y,{children:e.jsx(O,{sx:{overflow:"unset"},children:e.jsxs(H,{sx:{minWidth:800},children:[e.jsx(B,{order:a.order,orderBy:a.orderBy,rowCount:n.length,numSelected:a.selected.length,onSort:a.onSort,onSelectAllRows:o=>a.onSelectAllRows(o,n.map(s=>s.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),e.jsxs(L,{children:[p.slice(a.page*c,a.page*c+c).map(o=>e.jsx(F,{row:o,selected:a.selected.includes(o.id),onSelectRow:()=>a.onSelectRow(o.id)},o.id)),e.jsx(D,{height:68,emptyRows:I(a.page,a.rowsPerPage,n.length)}),C&&e.jsx(E,{searchQuery:r})]})]})})}),e.jsx(V,{component:"div",page:g-1,count:d,rowsPerPage:c,onPageChange:(o,s)=>P(s+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:o=>{f(parseInt(o.target.value,10)),P(1)}})]})]})}function Q(){const[n,m]=t.useState(0),[d,u]=t.useState("name"),[r,b]=t.useState(5),[l,h]=t.useState([]),[g,P]=t.useState("asc"),c=t.useCallback(s=>{P(d===s&&g==="asc"?"desc":"asc"),u(s)},[g,d]),f=t.useCallback((s,i)=>{if(s){h(i);return}h([])},[]),a=t.useCallback(s=>{const i=l.includes(s)?l.filter(S=>S!==s):[...l,s];h(i)},[l]),p=t.useCallback(()=>{m(0)},[]),C=t.useCallback((s,i)=>{m(i)},[]),o=t.useCallback(s=>{b(parseInt(s.target.value,10)),p()},[p]);return{page:n,order:g,onSort:c,orderBy:d,selected:l,rowsPerPage:r,onSelectRow:a,onResetPage:p,onChangePage:C,onSelectAllRows:f,onChangeRowsPerPage:o}}function _(){return e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsxs("title",{children:[" ",`Places - ${T.appName}`]})}),e.jsx(G,{})]})}export{_ as default};
