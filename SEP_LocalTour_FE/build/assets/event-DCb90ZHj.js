import{j as e,B as T,f as v,r as i,R as O,A as E,I as b,K as L,l as S,P as F,M as $,m as k,n as y,N as D,J as H,O as R,y as M,S as z,H as W}from"./index-DX4RbbSE.js";import{C as B}from"./config-global-BwHnWRtc.js";import{a as V}from"./index-Br0q4W-C.js";import{T as w,a as p,b as G,c as J,d as K,e as Q,f as q,g as U}from"./TableSortLabel-BeKEmkrD.js";import{C as N}from"./Checkbox-CP06dHPC.js";import{O as X}from"./Select-Bj2xuOC5.js";import{C as Y}from"./Card-DhZeIV4e.js";import"./LastPage-qsknSfb6.js";function Z({searchQuery:t,...n}){return e.jsx(w,{...n,children:e.jsx(p,{align:"center",colSpan:7,children:e.jsxs(T,{sx:{py:15,textAlign:"center"},children:[e.jsx(v,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(v,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function _({emptyRows:t,height:n,sx:s,...o}){return t?e.jsx(w,{sx:{...n&&{height:n*t},...s},...o,children:e.jsx(p,{colSpan:9})}):null}const ee={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function te(t,n,s){return t?Math.max(0,(1+t)*n-s):0}function A(t,n,s){return n[s]<t[s]?-1:n[s]>t[s]?1:0}function se(t,n){return t==="desc"?(s,o)=>A(s,o,n):(s,o)=>-A(s,o,n)}function ne({inputData:t,comparator:n,filterName:s}){const o=t.map((a,d)=>[a,d]);return o.sort((a,d)=>{const h=n(a[0],d[0]);return h!==0?h:a[1]-d[1]}),t=o.map(a=>a[0]),s&&(t=t.filter(a=>a.name.toLowerCase().indexOf(s.toLowerCase())!==-1)),t}function ae({row:t,selected:n,onSelectRow:s}){var x,C,l,m;const[o,a]=i.useState(null),d=O(),h=i.useCallback(g=>{g.stopPropagation(),a(g.currentTarget)},[]),r=i.useCallback(()=>{a(null)},[]),j=g=>{g.stopPropagation(),d(`/owner/event/place/${t.id}`)},P=g=>{g.target instanceof HTMLButtonElement||g.target instanceof HTMLInputElement||d(`/owner/event/place/${t.id}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(w,{hover:!0,tabIndex:-1,role:"checkbox",selected:n,onClick:P,children:[e.jsx(p,{padding:"checkbox",children:e.jsx(N,{disableRipple:!0,checked:n,onChange:s})}),e.jsx(p,{component:"th",scope:"row",children:e.jsxs(T,{gap:2,display:"flex",alignItems:"center",children:[e.jsx(E,{alt:((x=t.placeTranslation[0])==null?void 0:x.name)||"N/A",src:t.photoDisplay}),((C=t.placeTranslation[0])==null?void 0:C.name)||"N/A"]})}),e.jsx(p,{children:((l=t.placeTranslation[0])==null?void 0:l.address)||"N/A"}),e.jsx(p,{children:((m=t.placeTranslation[0])==null?void 0:m.description)||"N/A"}),e.jsx(p,{align:"center",children:t.status==="0"?"-":e.jsx(b,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}})}),e.jsx(p,{children:e.jsx(L,{color:t.status==="0"?"warning":t.status==="1"?"success":t.status==="2"?"error":"default",children:t.status==="0"?"Pending":t.status==="1"?"Approved":t.status==="2"?"Rejected":t.status})}),e.jsx(p,{align:"right",children:e.jsxs(S,{onClick:j,children:[" ",e.jsx(b,{icon:"eva:arrow-forward-outline",width:22})]})}),e.jsx(p,{align:"right",children:e.jsxs(S,{onClick:h,children:[" ",e.jsx(b,{icon:"eva:more-vertical-fill",width:22})]})})]}),e.jsx(F,{open:!!o,anchorEl:o,onClose:r,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs($,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${y.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${y.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(k,{onClick:r,children:[e.jsx(b,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(k,{onClick:r,sx:{color:"error.main"},children:[e.jsx(b,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}function oe({order:t,onSort:n,orderBy:s,rowCount:o,headLabel:a,numSelected:d,onSelectAllRows:h}){return e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(p,{padding:"checkbox",children:e.jsx(N,{indeterminate:d>0&&d<o,checked:o>0&&d===o,onChange:r=>h(r.target.checked)})}),a.map(r=>e.jsx(p,{align:r.align||"left",sortDirection:s===r.id?t:!1,sx:{width:r.width,minWidth:r.minWidth},children:e.jsxs(J,{hideSortIcon:!0,active:s===r.id,direction:s===r.id?t:"asc",onClick:()=>n(r.id),children:[r.label,s===r.id?e.jsx(T,{sx:{...ee},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))]})})}function re({numSelected:t,filterName:n,onFilterName:s}){return e.jsxs(D,{sx:{height:96,display:"flex",justifyContent:"space-between",p:o=>o.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(v,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(X,{fullWidth:!0,value:n,onChange:s,placeholder:"Search place...",startAdornment:e.jsx(H,{position:"start",children:e.jsx(b,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),t>0?e.jsx(R,{title:"Delete",children:e.jsx(S,{children:e.jsx(b,{icon:"solar:trash-bin-trash-bold"})})}):e.jsx(R,{title:"Filter list",children:e.jsx(S,{children:e.jsx(b,{icon:"ic:round-filter-list"})})})]})}const ie=async(t=1,n=5,s="vi")=>{const o=localStorage.getItem("accessToken");if(console.log("Access Token:",o),!o)return console.error("No access token found"),{items:[],totalCount:0};try{const a=await V.get(`https://api.localtour.space/api/Place/getAll?LanguageCode=${s}&Page=${t}&Size=${n}`,{headers:{Authorization:`Bearer ${o}`}});return console.log("API Response:",a.data),{items:a.data.items,totalCount:a.data.totalCount}}catch(a){return console.error("Error fetching places",a),{items:[],totalCount:0}}};function le(){const[t,n]=i.useState([]),[s,o]=i.useState(0),[a,d]=i.useState(""),[h,r]=i.useState("vi"),[j,P]=i.useState(1),[x,C]=i.useState(5);i.useEffect(()=>{(async()=>{const{items:c,totalCount:f}=await ie(j,x,h);n(c),o(f)})()},[j,x,h]);const l=ce(),m=ne({inputData:t,comparator:se(l.order,l.orderBy),filterName:a}),g=!m.length&&!!a;return e.jsxs(M,{children:[e.jsx(T,{display:"flex",alignItems:"center",mb:5,children:e.jsx(v,{variant:"h4",flexGrow:1,children:"Places"})}),e.jsxs(Y,{children:[e.jsx(re,{numSelected:l.selected.length,filterName:a,onFilterName:u=>{d(u.target.value),l.onResetPage()}}),e.jsx(z,{children:e.jsx(K,{sx:{overflow:"unset"},children:e.jsxs(Q,{sx:{minWidth:800},children:[e.jsx(oe,{order:l.order,orderBy:l.orderBy,rowCount:t.length,numSelected:l.selected.length,onSort:l.onSort,onSelectAllRows:u=>l.onSelectAllRows(u,t.map(c=>c.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),e.jsxs(q,{children:[m.slice(l.page*x,l.page*x+x).map(u=>e.jsx(ae,{row:u,selected:l.selected.includes(u.id),onSelectRow:()=>l.onSelectRow(u.id)},u.id)),e.jsx(_,{height:68,emptyRows:te(l.page,l.rowsPerPage,t.length)}),g&&e.jsx(Z,{searchQuery:a})]})]})})}),e.jsx(U,{component:"div",page:j-1,count:s,rowsPerPage:x,onPageChange:(u,c)=>P(c+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:u=>{C(parseInt(u.target.value,10)),P(1)}})]})]})}function ce(){const[t,n]=i.useState(0),[s,o]=i.useState("name"),[a,d]=i.useState(5),[h,r]=i.useState([]),[j,P]=i.useState("asc"),x=i.useCallback(c=>{P(s===c&&j==="asc"?"desc":"asc"),o(c)},[j,s]),C=i.useCallback((c,f)=>{if(c){r(f);return}r([])},[]),l=i.useCallback(c=>{const f=h.includes(c)?h.filter(I=>I!==c):[...h,c];r(f)},[h]),m=i.useCallback(()=>{n(0)},[]),g=i.useCallback((c,f)=>{n(f)},[]),u=i.useCallback(c=>{d(parseInt(c.target.value,10)),m()},[m]);return{page:t,order:j,onSort:x,orderBy:s,selected:h,rowsPerPage:a,onSelectRow:l,onResetPage:m,onChangePage:g,onSelectAllRows:C,onChangeRowsPerPage:u}}function fe(){return e.jsxs(e.Fragment,{children:[e.jsx(W,{children:e.jsxs("title",{children:[" ",`Event - ${B.appName}`]})}),e.jsx(le,{})]})}export{fe as default};
