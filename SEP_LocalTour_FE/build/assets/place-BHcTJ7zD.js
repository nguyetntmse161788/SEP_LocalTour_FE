import{j as e,m as D,n as m,B as C,T,r,O as L,a0 as E,A as H,I as y,a1 as M,V as k,E as O,M as z,F as R,J as I,l as W,a2 as V,Q as U,R as G,K as Q,h as F,U as J,D as K,C as Y,Y as q,i as X,k as Z,o as _,$ as ee,H as te}from"./index-z39hXFLl.js";import{C as se}from"./config-global-BwHnWRtc.js";import{a as $}from"./axiosInstance-Xq098mIU.js";function ne({searchQuery:t,...a}){return e.jsx(D,{...a,children:e.jsx(m,{align:"center",colSpan:7,children:e.jsxs(C,{sx:{py:15,textAlign:"center"},children:[e.jsx(T,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(T,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',t,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function ae({row:t,selected:a,onSelectRow:i}){var g,S,b,j;const[c,o]=r.useState(null),h=L(),d=r.useCallback(u=>{u.stopPropagation(),o(u.currentTarget)},[]),s=r.useCallback(()=>{o(null)},[]),x=u=>{u.stopPropagation(),h(`/place/${t.id}`)},f=u=>{u.target instanceof HTMLButtonElement||u.target instanceof HTMLInputElement||h(`/place/${t.id}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,onClick:f,children:[e.jsx(m,{padding:"checkbox",children:e.jsx(E,{disableRipple:!0,checked:a,onChange:i})}),e.jsx(m,{component:"th",scope:"row",children:e.jsxs(C,{gap:2,display:"flex",alignItems:"center",children:[e.jsx(H,{alt:((g=t.placeTranslation[0])==null?void 0:g.name)||"N/A",src:t.photoDisplay}),((S=t.placeTranslation[0])==null?void 0:S.name)||"N/A"]})}),e.jsx(m,{children:((b=t.placeTranslation[0])==null?void 0:b.address)||"N/A"}),e.jsx(m,{children:((j=t.placeTranslation[0])==null?void 0:j.description)||"N/A"}),e.jsx(m,{children:t.wardName||"N/A"}),e.jsx(m,{align:"center",children:t.status==="Pending"?"-":e.jsx(y,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}})}),e.jsx(m,{children:e.jsx(M,{color:t.status==="Pending"?"warning":t.status==="Approved"?"success":t.status==="Rejected"?"error":"default",children:t.status})}),e.jsx(m,{align:"right",children:e.jsxs(k,{onClick:x,children:[" ",e.jsx(y,{icon:"eva:arrow-forward-outline",width:22})]})}),e.jsx(m,{align:"right",children:e.jsxs(k,{onClick:d,children:[" ",e.jsx(y,{icon:"eva:more-vertical-fill",width:22})]})})]}),e.jsx(O,{open:!!c,anchorEl:c,onClose:s,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsxs(z,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${I.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${I.selected}`]:{bgcolor:"action.selected"}}},children:[e.jsxs(R,{onClick:s,children:[e.jsx(y,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(R,{onClick:s,sx:{color:"error.main"},children:[e.jsx(y,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})})]})}const re={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function oe(t,a,i){return t?Math.max(0,(1+t)*a-i):0}const ie=(t,a)=>(i,c)=>{if(a==="status"){const o=Number(i.status),h=Number(c.status);return t==="asc"?o-h:h-o}return 0},le=({inputData:t,comparator:a,filterName:i,filterStatus:c})=>{const o=[...t];return o.sort(a),o};function ce({order:t,onSort:a,orderBy:i,rowCount:c,headLabel:o,numSelected:h,onSelectAllRows:d}){return e.jsx(W,{children:e.jsxs(D,{children:[e.jsx(m,{padding:"checkbox",children:e.jsx(E,{indeterminate:h>0&&h<c,checked:c>0&&h===c,onChange:s=>d(s.target.checked)})}),o.map(s=>e.jsx(m,{align:s.align||"left",sortDirection:i===s.id?t:!1,sx:{width:s.width,minWidth:s.minWidth},children:e.jsxs(V,{hideSortIcon:!0,active:i===s.id,direction:i===s.id?t:"asc",onClick:()=>a(s.id),children:[s.label,i===s.id?e.jsx(C,{sx:{...re},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},s.id))]})})}function de({emptyRows:t,height:a,sx:i,...c}){return t?e.jsx(D,{sx:{...a&&{height:a*t},...i},...c,children:e.jsx(m,{colSpan:9})}):null}const he=async t=>{try{return(await $.get(`https://api.localtour.space/api/ModTag/UserTags/${t}`)).data.tags}catch(a){return console.error("Error fetching user districts:",a),[]}};function ue({numSelected:t,filterName:a,onFilterName:i,onFilterStatus:c,userId:o,onDistrictSelect:h}){const[d,s]=r.useState(null),[x,f]=r.useState(null),[g,S]=r.useState([]),[b,j]=r.useState([]);r.useEffect(()=>{(async()=>{const l=await he(o);S(l)})()},[o]);const u=n=>{j(l=>{const A=l.includes(n)?l.filter(B=>B!==n):[...l,n];return h(A),A})},v=n=>{const l=n==="All"?"":n;f(l),c(l),s(null)},N=n=>{s(n.currentTarget)},p=()=>{s(null)},w=!!d;return e.jsxs(U,{sx:{height:96,display:"flex",justifyContent:"space-between",p:n=>n.spacing(0,1,0,3),...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?e.jsxs(T,{component:"div",variant:"subtitle1",children:[t," selected"]}):e.jsx(G,{fullWidth:!0,value:a,onChange:i,placeholder:"Search place...",startAdornment:e.jsx(Q,{position:"start",children:e.jsx(y,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),e.jsx(C,{sx:{display:"flex",flexDirection:"row",gap:2},children:Array.isArray(g)&&g.length>0?g.map(n=>e.jsx(F,{onClick:()=>u(n.cityId),variant:b.includes(n.cityId)?"contained":"outlined",children:n.cityName},n.cityId)):e.jsx(T,{children:"No districts available"})}),t>0?e.jsx(k,{children:e.jsx(y,{icon:"solar:trash-bin-trash-bold"})}):e.jsxs(e.Fragment,{children:[e.jsx(J,{title:"Filter list",children:e.jsx(k,{onClick:N,children:e.jsx(y,{icon:"ic:round-filter-list"})})}),e.jsx(O,{open:w,anchorEl:d,onClose:p,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(C,{sx:{p:2,display:"flex",flexDirection:"column",gap:1},children:["All","Pending","Approved","Rejected"].map(n=>e.jsx(F,{variant:x===(n==="All"?null:n)?"contained":"outlined",onClick:()=>v(n==="All"?null:n),sx:{color:x===(n==="All"?null:n)?"text.primary":"text.secondary",borderColor:"text.secondary"},children:n},n))})})]})]})}const xe=async(t=1,a=5,i="vi",c="",o="",h=[])=>{const d=localStorage.getItem("accessToken");if(console.log("Access Token:",d),!d)return console.error("No access token found"),{items:[],totalCount:0};try{let s=`https://api.localtour.space/api/Place/getAllByRole?LanguageCode=${i}&Page=${t}&Size=${a}&SearchTerm=${encodeURIComponent(c)}&Status=${o}`;h.length>0&&(s+=`&DistrictNCityIds=${h.join("&DistrictNCityIds=")}`);const x=await $.get(s,{headers:{Authorization:`Bearer ${d}`}});return console.log("API Response:",x.data),{items:x.data.items,totalCount:x.data.totalCount}}catch(s){return console.error("Error fetching places",s),{items:[],totalCount:0}}};function pe(){const[t,a]=r.useState([]),[i,c]=r.useState(0),[o,h]=r.useState(""),[d,s]=r.useState("vi"),[x,f]=r.useState(1),[g,S]=r.useState(5),[b,j]=r.useState(""),[u,v]=r.useState([]),N=localStorage.getItem("userId");r.useEffect(()=>{(async()=>{const{items:P,totalCount:A}=await xe(x,g,d,o,b,u);a(P),c(A)})()},[x,g,d,o,b,u]);const p=ge(),w=le({inputData:t,comparator:ie(p.order,p.orderBy),filterName:o,filterStatus:b}),n=!w.length&&!!o;return e.jsxs(K,{children:[e.jsx(C,{display:"flex",alignItems:"center",mb:5,children:e.jsx(T,{variant:"h4",flexGrow:1,children:"Places"})}),e.jsxs(Y,{children:[e.jsx(ue,{numSelected:p.selected.length,filterName:o,onFilterName:l=>{h(l.target.value),f(1)},onFilterStatus:l=>{j(l||""),f(1)},userId:N||"",onDistrictSelect:v}),e.jsx(q,{children:e.jsx(X,{sx:{overflow:"unset"},children:e.jsxs(Z,{sx:{minWidth:800},children:[e.jsx(ce,{order:p.order,orderBy:p.orderBy,rowCount:t.length,numSelected:p.selected.length,onSort:p.onSort,onSelectAllRows:l=>p.onSelectAllRows(l,t.map(P=>P.id)),headLabel:[{id:"name",label:"Name"},{id:"address",label:"Address"},{id:"description",label:"Description"},{id:"wardName",label:"WardName"},{id:"isVerify",label:"isVerify"},{id:"status",label:"Status"},{id:"View details",label:"View details"},{id:""}]}),e.jsxs(_,{children:[w.slice(p.page*g,p.page*g+g).map(l=>e.jsx(ae,{row:l,selected:p.selected.includes(l.id),onSelectRow:()=>p.onSelectRow(l.id)},l.id)),e.jsx(de,{height:68,emptyRows:oe(p.page,p.rowsPerPage,t.length)}),n&&e.jsx(ne,{searchQuery:o})]})]})})}),e.jsx(ee,{component:"div",page:x-1,count:i,rowsPerPage:g,onPageChange:(l,P)=>f(P+1),rowsPerPageOptions:[5,10,25],onRowsPerPageChange:l=>{S(parseInt(l.target.value,10)),f(1)}})]})]})}function ge(){const[t,a]=r.useState(0),[i,c]=r.useState("name"),[o,h]=r.useState(5),[d,s]=r.useState([]),[x,f]=r.useState("asc"),g=r.useCallback(j=>{f(i===j&&x==="asc"?"desc":"asc"),c(j)},[x,i]),S=r.useCallback((j,u)=>{if(j){s(u);return}s([])},[]),b=r.useCallback(j=>{const u=d.includes(j)?d.filter(v=>v!==j):[...d,j];s(u)},[d]);return{order:x,orderBy:i,rowsPerPage:o,selected:d,page:t,onSort:g,onSelectAllRows:S,onSelectRow:b,onResetPage:()=>a(0)}}function be(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsxs("title",{children:[" ",`Places - ${se.appName}`]})}),e.jsx(pe,{})]})}export{be as default};
